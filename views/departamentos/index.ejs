<%- include('../parts/header.ejs') %>

<%- include('../parts/navbar.ejs') %>

<div class="ui container">
    <form action="/departamentos" method="POST">
        <input type="search" name="departamento_nome">
        <button>search</button>
    </form>
    <div class="containerButton">
        <a class="positive ui button right floated" href="/departamento/new" style="margin: 10px 0;">
            Adicionar Departamento
        </a>
    </div>
    <table class="ui striped table">
        <thead>
            <tr>
                <th>Departamento</th>
                <th class="right aligned">Ações</th>
            </tr>
        </thead>
        <tbody>
            <% departamentos.forEach(departamento=> { %>
                <tr>
                    <td>
                        <%=departamento.departamento_nome %>
                    </td>
                    <td class="right aligned">
                        <a class="ui icon button blue" href="/departamento/edit/<%=departamento.departamento_id %>">
                            <i class="edit icon"></i>
                            Editar
                        </a>
    
                        <form action="/departamento/delete/<%=departamento.departamento_id %>" method="POST"
                            onsubmit="confirmDelete(event, this)" style="display: inline;">
                            <input type="hidden" value="<%=departamento.departamento_id %>">
                            <button class="ui icon button red">
                                <i class="delete icon"></i>
                                Excluir
                            </button>
                        </form>
                    </td>
                </tr>
            <% }) %>
        </tbody>
    </table>
</div>

<%- include('../parts/footer.ejs') %>

<script>
    function confirmDelete(event, form) {
        event.preventDefault();
        var decision = confirm('Você deseja deletar este departamento?');
        if (decision) {
            form.submit();
        }
    }
</script>
